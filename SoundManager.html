<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoundManager2 Audio Player</title>
    <script src="https://lornamobileappsdev.uk/mobileAppsWebsite/soundmanager2/script/soundmanager2.js"></script>
</head>
<body>
    <div id="player-container">
        <button id="playButton">▶</button>
        <div id="progress" style="display: none;">Loading...</div>
    </div>

    <!-- Flash Object Fallback -->
    <object 
        type="application/x-shockwave-flash" 
        data="https://lornamobileappsdev.uk/mobileAppsWebsite/soundmanager2/swf/soundmanager2.swf" 
        width="0" 
        height="0">
        <param name="movie" value="https://lornamobileappsdev.uk/mobileAppsWebsite/soundmanager2/swf/soundmanager2.swf">
        <param name="quality" value="high">
        <param name="wmode" value="transparent">
    </object>

<script>
    // Prefer HTML5 but use Flash as a fallback
    soundManager.useHTML5Audio = true;
    soundManager.useFlashBlock = false;
    soundManager.preferFlash = false;

    // Set up SoundManager2
    soundManager.setup({
        url: 'https://lornamobileappsdev.uk/mobileAppsWebsite/soundmanager2/swf/',
        flashVersion: 9,
        debugMode: false,
        onready: function () {
            console.log('SoundManager2 is ready!');

            const playButton = document.getElementById('playButton');
            const progress = document.getElementById('progress');
            let sound;

            // Function to create and play the sound
            function createAndPlaySound() {
                progress.style.display = 'block'; // Show loading progress
                sound = soundManager.createSound({
                    id: 'stationSound',
                    url: 'http://s4-webradio.rockantenne.de/rockantenne?timestamp=' + Date.now(),
                    autoPlay: true,
                    onload: function (success) {
                        progress.style.display = 'none';
                        if (success) {
                            console.log('Audio loaded and playing!');
                            playButton.textContent = '||'; // Change to pause button
                        } else {
                            console.error('Failed to load audio.');
                            alert('Error: Unable to load audio.');
                            playButton.textContent = '▶'; // Reset to play button
                            sound = null;
                        }
                    },
                    onfinish: function () {
                        console.log('Audio finished playing');
                        playButton.textContent = '▶'; // Reset to play button
                        sound.destruct(); // Clean up the sound object
                        sound = null;
                    },
                    onerror: function () {
                        console.error('Error during playback.');
                        alert('Error: Playback failed.');
                        playButton.textContent = '▶';
                        sound = null;
                    }
                });
            }

            // Handle play/pause button clicks
            playButton.addEventListener('click', function () {
                if (!sound) {
                    // Create and play sound if not already created
                    createAndPlaySound();
                } else if (sound.playState === 1 && !sound.paused) {
                    // If playing, pause the sound
                    sound.pause();
                    soundManager.destroySound()
                    playButton.textContent = '▶'; // Change to play button
                } else {
                    // If paused, resume playing
                    sound.play();
                    playButton.textContent = '||'; // Change to pause button
                }
            });
        },
        ontimeout: function () {
            console.error('SoundManager2 setup failed or timed out.');
            alert('Error: Unable to initialize audio playback.');
        }
    });
</script>


</body>
</html>
